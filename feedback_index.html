<!-- This is a simple HTML page that includes a button that triggers an AJAX (Asynchronous JavaScript and XML) request to a PHP script called 'feedback-database.php'. 
     The response from the PHP script is displayed in a container with id "tips-container" in the HTML page. -->
<!DOCTYPE html>
<html>
    <head>
    <title>Front-to-Back Feedback Buttons</title>
    </head>
    <body>
    <!-- Button triggers an AJAX request to a PHP script -->
    <button type="button" onclick="loadDoc()">Show Database</button>

    <!-- HTML code -->
    <div id="tips-container"></div>

    <script>
    // AJAX request
function loadDoc() {
    var xmlhttp = new XMLHttpRequest();
    xmlhttp.onreadystatechange = function() {
        if (this.readyState == 4 && this.status == 200) {
            document.getElementById("tips-container").innerHTML = this.responseText;

            // Add event listeners to each 'yes' and 'no' button
            // When a user clicks on a 'yes' or 'no' button, the corresponding button is disabled and both buttons cannot be clicked again
            var yesBtns = document.getElementsByClassName("yesBtn");
            for (var i = 0; i < yesBtns.length; i++) {                                              // Iterates over all 'yes' buttons in HTML document
                yesBtns[i].addEventListener("click", function() {
                    // Expected format of button id is 'yesBtn-1', where the number represents the tip id
                    // split("-") method is used to split the id string at the "-" character, 
                    // creating an array with two elements: 'yesBtn' and the tip id
                    // The [1] index is used to select the second element of the array
                    var tipId = this.id.split("-")[1];                                              // Get the tip id from the button id

                    console.log("User clicked 'Yes' for Tip " + tipId);                             // Check if event listener is working, prints in web browser console log
                    
                    // Disable the 'no' button for this tip
                    var noBtn = document.getElementById("noBtn-" + tipId);
                    this.disabled = false;                                                          // Yes button is not disabled
                    this.style.pointerEvents = 'none';                                              // Yes button cannot be clicked again
                    noBtn.disabled = true;                                                          // No button is disabled
                    noBtn.style.pointerEvents = 'none';                                             // No button cannot be clicked again
                    
                    // Store the state of this tip in sessionStorage
                    sessionStorage.setItem("tip-" + tipId, "yes");
                });
            }

            var noBtns = document.getElementsByClassName("noBtn");
            for (var i = 0; i < noBtns.length; i++) {
                noBtns[i].addEventListener("click", function() {
                    var tipId = this.id.split("-")[1];                                              // Get the tip id from the button id

                    console.log("User clicked 'No' for Tip " + tipId);                              // Check if event listener is working, prints in web browser console log
                    
                    // Disable the 'yes' button for this tip
                    var yesBtn = document.getElementById("yesBtn-" + tipId);
                    this.disabled = false;                                                          // No button is not disabled
                    this.style.pointerEvents = 'none';                                              // No button cannot be clicked again
                    yesBtn.disabled = true;                                                         // Yes button is disabled
                    yesBtn.style.pointerEvents = 'none';                                            // Yes button cannot be clicked again
                    
                    // Store the state of this tip in sessionStorage
                    sessionStorage.setItem("tip-" + tipId, "no");
                });
            }

            // Retrieve the state of each tip from sessionStorage
            for (var i = 0; i < yesBtns.length; i++) {
                var tipId = yesBtns[i].id.split("-")[1];
                var state = sessionStorage.getItem("tip-" + tipId);
                if (state === "yes") {
                    yesBtns[i].disabled = false;
                    yesBtns[i].style.pointerEvents = 'none';
                    var noBtn = document.getElementById("noBtn-" + tipId);
                    noBtn.disabled = true;
                    noBtn.style.pointerEvents = 'none';
                } else if (state === "no") {
                    var noBtn = document.getElementById("noBtn-" + tipId);
                    noBtn.disabled = false;
                    noBtn.style.pointerEvents = 'none';
                    yesBtns[i].disabled = true;
                    yesBtns[i].style.pointerEvents = 'none';
                }
            }
        }
    };
    xmlhttp.open("GET", "feedback_database.php", true);
    xmlhttp.send();
}
    </script>
  </body>
</html>
